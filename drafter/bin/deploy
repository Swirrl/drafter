#!/usr/bin/env bash

drafter="$( cd "$(dirname "$0")/.." ; pwd -P )"

cd $drafter

DRAFTER_VERSION=$(cat "$drafter/VERSION")
REPOSITORY=swirrl-private-jars-snapshots

if [ -n "$TRAVIS_TAG" ]; then
  DRAFTER_VERSION=$TRAVIS_TAG
  REPOSITORY=swirrl-private-jars-releases
fi

echo Deploying drafter version $DRAFTER_VERSION to repository $REPOSITORY

clojure -A:krunk krunk.edn \
      :repository-id "\"$REPOSITORY\"" \
      :group-id drafter \
      :artifact-id drafter \
      :version "\"$DRAFTER_VERSION\"" \
      :jar-file \"./target/drafter.jar\"
